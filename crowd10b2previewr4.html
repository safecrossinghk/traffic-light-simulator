<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<title>ğŸ“å³æ™‚åŠé è¨ˆäººæµæŸ¥è©¢</title>
<style>
body { font-family: Arial, sans-serif; text-align: center; padding: 20px; }
input, button { font-size: 1.2em; margin: 5px; }
#result, #forecast, #error { margin-top: 20px; white-space: pre-wrap; font-size: 1.1em; }
#result { color: green; }
#error { color: red; }
</style>
</head>
<body>
<h2>ğŸ“å³æ™‚åŠé è¨ˆäººæµæŸ¥è©¢</h2>
<input id="place" type="text" placeholder="è«‹è¼¸å…¥åœ°é»åç¨±ï¼Œä¾‹å¦‚ æ—ºè§’æœ—è±ªåŠ">
<button onclick="doQuery()">æŸ¥è©¢</button>

<div id="result"></div>
<div id="forecast"></div>
<div id="error"></div>

<script>
async function doQuery() {
const place = document.getElementById('place').value.trim();
document.getElementById('result').textContent = '';
document.getElementById('forecast').textContent = '';
document.getElementById('error').textContent = '';

if (!place) {
document.getElementById('error').textContent = 'âŒ è«‹è¼¸å…¥åœ°é»åç¨±ã€‚';
return;
}

try {
const res = await fetch(`https://sweet-credit-68c9.ctakwah.workers.dev/?query=${encodeURIComponent(place)}`);
const data = await res.json();

if (!data.success) {
document.getElementById('error').textContent = `âŒ æŸ¥è©¢éŒ¯èª¤ï¼š${data.message || 'æœªçŸ¥éŒ¯èª¤'}`;
return;
}

const now = data.popular_times.find(p => p.day === 'live');
const future = data.popular_times.filter(p => p.day && p.hour !== undefined && p.day !== 'live');

let msg = `âœ… åœ°é»ï¼š${place}ï¼ˆæŸ¥è©¢ï¼š${data.query}ï¼‰\n`;
if (now) {
msg += `\nğŸ“Œ ç¾æ™‚äººæµï¼š${now.value}%`;
document.getElementById('result').textContent = msg;
}

if (future.length > 0) {
let forecastMsg = '\nğŸ“… é æ¸¬äººæµæ™‚æ®µï¼š\n';
for (let i = 0; i < Math.min(future.length, 6); i++) {
const f = future[i];
forecastMsg += `ğŸ•’ ${f.day} ${f.hour}:00 âœ ${f.value}%\n`;
}
document.getElementById('forecast').textContent = forecastMsg;
}

if (!now && future.length === 0) {
document.getElementById('error').textContent = 'âš ï¸ æœªæœ‰æ­¤åœ°é»çš„äººæµè³‡æ–™ã€‚';
}

} catch (e) {
document.getElementById('error').textContent = `âŒ ç³»çµ±éŒ¯èª¤ï¼š${e.message}`;
}
}
</script>
</body>
</html>