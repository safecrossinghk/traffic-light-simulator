<!DOCTYPE html>
<html lang="zh-HK">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>è”æè§’äººæµ + Waze åœ°åœ–</title>
<style>
body {
font-family: "Helvetica", sans-serif;
margin: 0;
background-color: #f8f9fa;
}
header {
background-color: #005eb8;
color: white;
padding: 1em;
text-align: center;
}
.container {
display: flex;
flex-direction: row;
flex-wrap: wrap;
padding: 1em;
}
.locations, .map, .status {
flex: 1 1 300px;
margin: 0.5em;
}
button {
display: block;
width: 100%;
margin: 0.3em 0;
padding: 0.6em;
font-size: 1em;
background-color: #0078d4;
color: white;
border: none;
border-radius: 5px;
}
button:hover {
background-color: #005fa3;
cursor: pointer;
}
iframe {
width: 100%;
height: 400px;
border: none;
}
.status-box {
background: #ffffff;
padding: 1em;
border-radius: 5px;
box-shadow: 0 0 10px rgba(0,0,0,0.1);
}
@media (max-width: 768px) {
.container {
flex-direction: column;
}
}
</style>
</head>
<body>
<header>
<h1>è”æè§’äººæµç‹€æ³ + Waze å³æ™‚äº¤é€š</h1>
</header>

<div class="container">
<div class="locations">
<button onclick="selectLocation('è”æè§’åœ°éµç«™å‡ºå£ A')">è”æè§’åœ°éµç«™å‡ºå£ A</button>
<button onclick="selectLocation('D2 Place')">D2 Place</button>
<button onclick="selectLocation('é•·æ²™ç£å»£å ´')">é•·æ²™ç£å»£å ´</button>
<button onclick="selectLocation('D2 Place Two')">D2 Place Two</button>
<button onclick="selectLocation('æ³“æ™¯åŒ¯')">æ³“æ™¯åŒ¯</button>
</div>

<div class="map">
<iframe id="wazeMap" src="https://embed.waze.com/iframe?zoom=16&lat=22.3389&lon=114.1516" allowfullscreen></iframe>
</div>

<div class="status">
<div class="status-box" id="statusBox">
ğŸ“ è«‹é»é¸å·¦æ–¹åœ°é»é–‹å§‹æŸ¥è©¢äººæµç‹€æ…‹ã€‚
</div>
</div>
</div>

<script>
const locations = {
"è”æè§’åœ°éµç«™å‡ºå£ A": {
lat: 22.339258,
lon: 114.149937,
query: "Lai Chi Kok MTR Exit A"
},
"D2 Place": {
lat: 22.337397,
lon: 114.149699,
query: "D2 Place One"
},
"é•·æ²™ç£å»£å ´": {
lat: 22.337737,
lon: 114.153652,
query: "Cheung Sha Wan Plaza"
},
"D2 Place Two": {
lat: 22.337153,
lon: 114.148563,
query: "D2 Place Two"
},
"æ³“æ™¯åŒ¯": {
lat: 22.336565,
lon: 114.152424,
query: "The Pacifica"
}
};

function selectLocation(name) {
const loc = locations[name];
if (!loc) return;

// æ›´æ–°åœ°åœ–
const wazeUrl = `https://embed.waze.com/iframe?zoom=16&lat=${loc.lat}&lon=${loc.lon}`;
document.getElementById("wazeMap").src = wazeUrl;

// æ›´æ–°ç‹€æ…‹æ–‡å­— + æŸ¥è©¢
document.getElementById("statusBox").innerHTML = `â³ æ­£åœ¨æŸ¥è©¢ ${name} çš„äººæµç‹€æ³...`;

// æŸ¥è©¢ Outscraper API
fetch(`https://api.app.outscraper.com/maps/search-v2`, {
method: 'POST',
headers: {
'X-API-KEY': 'MWE3NWNmMzFjZWNiNGMxMDlhNGNhNDFjNTY3ZjZkMTB8NzY5ZGY0MGQ0Zg',
'Content-Type': 'application/json'
},
body: JSON.stringify({
query: loc.query,
limit: 1,
language: "zh"
})
})
.then(response => response.json())
.then(data => {
const result = data.data?.[0]?.popular_times?.find(pt => pt.name === (new Date()).toLocaleString('en-US', { weekday: 'long' }));
const hour = new Date().getHours();
const level = result?.data?.[hour] ?? "æœªçŸ¥";

const message = `ğŸ“ ${name}<br>ğŸ•’ ç¾æ™‚äººæµï¼š${level}ï¼ˆ${hour}:00ï¼‰`;
document.getElementById("statusBox").innerHTML = message;

speak(`${name} ç¾æ™‚äººæµç‚º ${level}`);
})
.catch(err => {
console.error(err);
document.getElementById("statusBox").innerHTML = `âš ï¸ æŸ¥è©¢å¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦ã€‚`;
});
}

function speak(text) {
const utter = new SpeechSynthesisUtterance(text);
utter.lang = "zh-HK"; // ç²µèªå„ªå…ˆï¼Œfallback ç‚ºæ™®é€šè©±
speechSynthesis.speak(utter);
}
</script>
</body>
</html>