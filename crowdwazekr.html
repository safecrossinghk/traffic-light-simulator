<!DOCTYPE html>
<html lang="zh-HK">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>è”æè§’äººæµ + Waze åœ°åœ–</title>
<style>
html, body {
margin: 0;
padding: 0;
height: 100%;
}
iframe {
width: 100%;
height: 100%;
border: none;
}
#weatherInfo {
position: absolute;
top: 10px;
left: 10px;
background: rgba(255,255,255,0.9);
padding: 10px;
font-family: sans-serif;
font-size: 14px;
z-index: 9999;
box-shadow: 0 0 5px rgba(0,0,0,0.2);
}
</style>
</head>
<body>
<div id="weatherInfo">
<div id="temp">ğŸŒ¡ æ°£æº«ï¼šè®€å–ä¸­...</div>
<div id="rain">â˜” é›¨é‡ï¼šè®€å–ä¸­...</div>
</div>

<iframe src="https://embed.waze.com/iframe?zoom=14&lat=22.336&lon=114.148&pin=1&marker=1&desc=è”æè§’" allowfullscreen></iframe>

<script>
async function fetchWeather() {
try {
const res = await fetch("https://crowdwazefr2.ctakwah.workers.dev?mode=weather");
const data = await res.json();

// é¡¯ç¤ºæ°£æº«èˆ‡é›¨é‡
document.getElementById("temp").innerText = `ğŸŒ¡ æ°£æº«ï¼š${data.temperature}Â°C`;
document.getElementById("rain").innerText = `â˜” é›¨é‡ï¼š${data.rain} æ¯«ç±³`;

// è‹¥é›¨é‡ > 5 æ¯«ç±³ï¼Œè‡ªå‹•èªéŸ³æç¤º
if (data.rain && data.rain !== "ä¸è©³") {
const rain = parseFloat(data.rain);
if (rain > 5) {
const msg = `âš ï¸ æ³¨æ„ï¼è”æè§’åœ°å€é›¨é‡é” ${rain} æ¯«ç±³ï¼Œè«‹æ³¨æ„å®‰å…¨ã€‚`;
const utterance = new SpeechSynthesisUtterance(msg);
utterance.lang = 'zh-HK';
speechSynthesis.speak(utterance);
}
}
} catch (e) {
document.getElementById("temp").innerText = "ğŸŒ¡ æ°£æº«ï¼šéŒ¯èª¤";
document.getElementById("rain").innerText = "â˜” é›¨é‡ï¼šéŒ¯èª¤";
console.error("ç„¡æ³•è¼‰å…¥å¤©æ°£è³‡æ–™ï¼š", e);
}
}

fetchWeather();
</script>
</body>
</html>