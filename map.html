<!DOCTYPE html>
<html lang="zh-HK">
<head>
<meta charset="UTF-8">
<title>å³æ™‚è»ŠæµæŸ¥è©¢ï¼ˆé¦™æ¸¯ï¼‰</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body { font-family: Arial, sans-serif; text-align: center; margin: 0; }
#mapContainer { width: 100%; height: 500px; }
button { padding: 10px 20px; margin: 10px; font-size: 16px; }
#status { margin-top: 10px; font-size: 18px; }
</style>
<script src="https://webapi.amap.com/maps?v=2.0&key=c739c1ac829fc2acf00599662cca95f9"></script>
</head>
<body>
<h2>å³æ™‚è»ŠæµæŸ¥è©¢ï¼ˆé¦™æ¸¯ï¼‰</h2>
<div id="mapContainer"></div>
<button onclick="getLocation()">ğŸ“ æŸ¥è©¢ç›®å‰è»Šæµ</button>
<button onclick="toggleLanguage()">ğŸŒ åˆ‡æ›èªè¨€</button>
<p id="status">è«‹é»æ“ŠæŒ‰éˆ•æŸ¥è©¢é™„è¿‘è»Šæµæƒ…æ³ã€‚</p>
<script>
let currentLang = 'zh-HK';
let map, marker;

function speak(text, lang = 'zh-HK') {
if (!window.speechSynthesis) return;
const msg = new SpeechSynthesisUtterance(text);
msg.lang = lang;
window.speechSynthesis.cancel();
window.speechSynthesis.speak(msg);
}

function initMap(lng, lat) {
map = new AMap.Map('mapContainer', {
resizeEnable: true,
zoom: 15,
center: [lng, lat]
});

AMap.plugin('AMap.ToolBar', function () {
map.addControl(new AMap.ToolBar());
});

map.setTrafficOn(true);

if (marker) map.remove(marker);
marker = new AMap.Marker({
position: [lng, lat],
map: map
});

const msg = currentLang === 'zh-HK' ? "å·²é¡¯ç¤ºæ‚¨é™„è¿‘çš„å³æ™‚è»Šæµã€‚" : "Traffic near your location is displayed.";
document.getElementById("status").textContent = msg;
speak(msg, currentLang);
}

function getLocation() {
if (navigator.geolocation) {
navigator.geolocation.getCurrentPosition(position => {
const lng = position.coords.longitude;
const lat = position.coords.latitude;
initMap(lng, lat);
}, () => {
const errorMsg = currentLang === 'zh-HK' ? "ç„¡æ³•å–å¾—æ‚¨çš„ä½ç½®ã€‚" : "Failed to get your location.";
document.getElementById("status").textContent = errorMsg;
speak(errorMsg, currentLang);
});
}
}

function toggleLanguage() {
currentLang = currentLang === 'zh-HK' ? 'en-US' : 'zh-HK';
const msg = currentLang === 'zh-HK' ? "å·²åˆ‡æ›ç‚ºç²µèªæç¤ºã€‚" : "Switched to English voice.";
document.getElementById("status").textContent = msg;
speak(msg, currentLang);
}
</script>
</body>
</html>
