<!-- nearbycrowd_fixed.html -->
<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8" />
<title>äººæµå¯¦æ™‚æŸ¥è©¢ï¼ˆæŒ‡å®šåœ°é»ï¼‰</title>
<style>
body { font-family: sans-serif; }
#output { margin-top: 1em; }
.location-block { margin-bottom: 1em; border-bottom: 1px solid #ccc; padding-bottom: 0.5em; }
</style>
</head>
<body>
<h1>æ¸¯å£åœ°é»äººæµæŸ¥è©¢</h1>
<button onclick="fetchFixedLocations()">ğŸ”„ æ‰‹å‹•æ›´æ–°</button>
<div id="output">è¼‰å…¥ä¸­...</div>

<script>
const apiKey = 'MWE3NWNmMzFjZWNiNGMxMDlhNGNhNDFjNTY3ZjZkMTB8NzY5ZGY0MGQ0Zg'; // â† æ›æˆä½ çš„ Outscraper é‡‘é‘°
const locations = [
{ name: "é¦™æ¸¯åœ‹éš›æ©Ÿå ´", lat: 22.3080, lng: 113.9185 },
{ name: "é«˜éµè¥¿ä¹é¾ç«™", lat: 22.3042, lng: 114.1594 },
{ name: "ç¾…æ¹–å£å²¸", lat: 22.5336, lng: 114.1136 },
{ name: "ç¦ç”°å£å²¸", lat: 22.5155, lng: 114.0685 },
{ name: "è“®å¡˜å£å²¸", lat: 22.5566, lng: 114.1515 },
{ name: "æ·±åœ³ç£å£å²¸", lat: 22.5017, lng: 113.9278 },
{ name: "æ¸¯ç æ¾³å¤§æ©‹å£å²¸", lat: 22.3040, lng: 113.9430 },
{ name: "çš‡å´—å£å²¸", lat: 22.5212, lng: 114.0714 }
];

async function fetchFixedLocations() {
document.getElementById('output').innerHTML = 'ğŸ”„ æ­£åœ¨è¼‰å…¥è³‡æ–™...';
let html = '';
for (const loc of locations) {
try {
const url = `https://api.outscraper.com/maps/search-v2?query=${encodeURIComponent(loc.name)}&limit=1&lat=${loc.lat}&lng=${loc.lng}`;
const res = await fetch(url, {
headers: { 'X-API-KEY': apiKey }
});
const data = await res.json();
const place = data.data?.places[0];
const popularity = place?.popular_times?.[new Date().getDay()] || null;
const current = place?.current_popularity ?? null;
const crowd = current !== null ? `å³æ™‚äººæµï¼š${current}%` : 'âš ï¸ åƒ…æä¾›æ­·å²äººæµè³‡æ–™';
html += `<div class="location-block"><strong>${loc.name}</strong><br>${crowd}</div>`;
} catch (e) {
html += `<div class="location-block"><strong>${loc.name}</strong><br>âŒ ç„¡æ³•å–å¾—è³‡æ–™</div>`;
}
}
document.getElementById('output').innerHTML = html;
}

fetchFixedLocations();
setInterval(fetchFixedLocations, 5 * 60 * 1000);
</script>
</body>
</html>